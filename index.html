<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PATRIOTS PROTOCOL - Enhanced Cyber Intelligence v4.2</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #00ff41;
            font-family: 'Share Tech Mono', monospace;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Enhanced Matrix Background - More Visible Numbers Only */
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            opacity: 0.15;
        }

        .matrix-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(ellipse at 20% 80%, rgba(255, 68, 68, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 20%, rgba(0, 255, 65, 0.06) 0%, transparent 50%),
                linear-gradient(135deg, rgba(0, 0, 0, 0.85) 0%, rgba(0, 0, 0, 0.95) 100%);
            pointer-events: none;
        }

        /* Floating Numbers Matrix Effect */
        .number-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }

        .number-column {
            position: absolute;
            top: -100px;
            color: #00ff41;
            font-size: 14px;
            line-height: 16px;
            animation: number-fall linear infinite;
            opacity: 0.7;
            font-family: 'Share Tech Mono', monospace;
        }

        @keyframes number-fall {
            to {
                transform: translateY(calc(100vh + 100px));
            }
        }

        .header {
            text-align: center;
            padding: 2rem;
            border-bottom: 2px solid #00ff41;
            background: 
                linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.9)),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 98px,
                    rgba(0, 255, 65, 0.02) 100px
                );
            position: relative;
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 32px rgba(0, 255, 65, 0.3);
        }

        .title {
            font-family: 'Orbitron', monospace;
            font-size: 3.2rem;
            font-weight: 900;
            text-shadow: 
                0 0 10px #00ff41,
                0 0 20px #00ff41,
                0 0 40px #00ff41;
            animation: neon-glow 4s ease-in-out infinite alternate;
            margin-bottom: 1rem;
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #ff6666;
            text-shadow: 0 0 10px #ff6666;
            margin-bottom: 1rem;
        }

        @keyframes neon-glow {
            from { 
                text-shadow: 
                    0 0 10px #00ff41,
                    0 0 20px #00ff41,
                    0 0 40px #00ff41;
            }
            to { 
                text-shadow: 
                    0 0 20px #00ff41,
                    0 0 30px #00ff41,
                    0 0 60px #00ff41,
                    0 0 100px #00ff41;
            }
        }

        .version-badge {
            background: linear-gradient(45deg, rgba(255, 68, 68, 0.4), rgba(255, 68, 68, 0.2));
            border: 2px solid #ff4444;
            color: #ff4444;
            padding: 0.6rem 1.4rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            display: inline-block;
            box-shadow: 
                0 0 20px rgba(255, 68, 68, 0.4),
                inset 0 0 20px rgba(255, 68, 68, 0.1);
            animation: version-pulse 2s infinite;
        }

        @keyframes version-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 68, 68, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 68, 68, 0.6), 0 0 40px rgba(255, 68, 68, 0.2); }
        }

        .container {
            max-width: 1900px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
        }

        .enhanced-controls {
            background: 
                linear-gradient(135deg, rgba(255, 68, 68, 0.12), rgba(255, 68, 68, 0.06)),
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 4px,
                    rgba(255, 68, 68, 0.02) 6px
                );
            border: 2px solid #ff4444;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2.5rem;
            backdrop-filter: blur(20px);
            box-shadow: 
                0 8px 32px rgba(255, 68, 68, 0.2),
                inset 0 0 50px rgba(255, 68, 68, 0.05);
            position: relative;
            overflow: hidden;
        }

        .enhanced-controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.1), transparent);
            animation: scan-line 3s infinite;
        }

        @keyframes scan-line {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .controls-title {
            color: #ff4444;
            font-size: 1.4rem;
            font-weight: bold;
            text-shadow: 0 0 15px #ff4444;
            font-family: 'Orbitron', monospace;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: #00ff41;
            font-size: 1rem;
            font-weight: bold;
        }

        .live-dot {
            width: 12px;
            height: 12px;
            background: #00ff41;
            border-radius: 50%;
            animation: cyber-pulse 2s infinite;
            box-shadow: 0 0 20px #00ff41;
        }

        @keyframes cyber-pulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 20px #00ff41;
            }
            50% { 
                opacity: 0.7; 
                transform: scale(1.3);
                box-shadow: 0 0 30px #00ff41, 0 0 40px #00ff41;
            }
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .filter-label {
            color: #ff6666;
            font-size: 0.85rem;
            font-weight: bold;
            text-transform: uppercase;
            text-shadow: 0 0 8px #ff6666;
            letter-spacing: 1px;
        }

        .filter-select, .search-input {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #ff4444;
            color: #00ff41;
            padding: 0.8rem;
            border-radius: 8px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .search-input {
            border-color: #ffd700;
            color: #ffd700;
        }

        .search-input::placeholder {
            color: rgba(255, 215, 0, 0.6);
        }

        .filter-select:focus, .search-input:focus {
            outline: none;
            box-shadow: 
                0 0 20px rgba(255, 68, 68, 0.6),
                inset 0 0 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
            border-color: #00ff41;
        }

        .action-buttons {
            display: flex;
            gap: 1.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .action-btn {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            border: 2px solid #ffd700;
            color: #ffd700;
            padding: 0.8rem 1.6rem;
            border-radius: 8px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .action-btn:hover {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.5), rgba(255, 215, 0, 0.3));
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(255, 215, 0, 0.5),
                0 0 30px rgba(255, 215, 0, 0.3);
            text-shadow: 0 0 10px #ffd700;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2.5rem;
            margin-bottom: 3rem;
        }

        .metrics-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .metric-card {
            background: 
                linear-gradient(135deg, rgba(255, 68, 68, 0.12), rgba(255, 68, 68, 0.06)),
                radial-gradient(circle at 30% 70%, rgba(0, 255, 65, 0.05), transparent);
            border: 2px solid rgba(255, 68, 68, 0.8);
            padding: 1.8rem;
            border-radius: 12px;
            backdrop-filter: blur(15px);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(255, 68, 68, 0.2),
                inset 0 0 30px rgba(255, 68, 68, 0.05);
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.15), transparent);
            transition: left 0.6s;
        }

        .metric-card:hover::before {
            left: 100%;
        }

        .metric-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 
                0 15px 40px rgba(255, 68, 68, 0.4),
                0 0 50px rgba(0, 255, 65, 0.2);
            border-color: #00ff41;
        }

        .metric-card.critical {
            border-color: #ff0000;
            background: 
                linear-gradient(135deg, rgba(255, 0, 0, 0.2), rgba(255, 0, 0, 0.1)),
                radial-gradient(circle at 50% 50%, rgba(255, 0, 0, 0.1), transparent);
            animation: critical-alert 3s infinite;
        }

        @keyframes critical-alert {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
                border-color: #ff0000;
            }
            50% { 
                box-shadow: 
                    0 0 40px rgba(255, 0, 0, 0.8), 
                    0 0 60px rgba(255, 0, 0, 0.4);
                border-color: #ff4444;
            }
        }

        .metric-title {
            font-size: 0.8rem;
            color: #ff6666;
            margin-bottom: 1rem;
            text-transform: uppercase;
            font-weight: bold;
            text-shadow: 0 0 8px #ff6666;
            letter-spacing: 1px;
        }

        .metric-value {
            font-size: 2.4rem;
            font-weight: bold;
            margin-bottom: 0.8rem;
            text-shadow: 0 0 15px currentColor;
            font-family: 'Orbitron', monospace;
        }

        .metric-details {
            font-size: 0.8rem;
            color: #cccccc;
            line-height: 1.4;
        }

        .analytics-panel {
            background: 
                linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(255, 68, 68, 0.05)),
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 3px,
                    rgba(0, 255, 65, 0.02) 5px
                );
            border: 2px solid #ff4444;
            border-radius: 15px;
            padding: 2rem;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(255, 68, 68, 0.2);
        }

        .analytics-title {
            color: #ff4444;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 15px #ff4444;
            font-family: 'Orbitron', monospace;
        }

        .intelligence-section {
            margin-top: 4rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #ff4444;
            position: relative;
        }

        .section-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #ff4444, #00ff41, #ffd700, #ff4444);
            animation: border-flow 3s linear infinite;
        }

        @keyframes border-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .section-title {
            font-size: 2.2rem;
            color: #ff4444;
            text-shadow: 0 0 20px #ff4444;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
        }

        .section-stats {
            display: flex;
            gap: 2rem;
            font-size: 1rem;
            align-items: center;
        }

        .threat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
        }

        .threat-card {
            background: 
                linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6)),
                radial-gradient(circle at 20% 80%, rgba(255, 68, 68, 0.05), transparent),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 65, 0.03), transparent);
            border: 2px solid rgba(255, 68, 68, 0.6);
            padding: 2.5rem;
            border-radius: 15px;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .threat-card:hover {
            background: 
                linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.7)),
                radial-gradient(circle at 50% 50%, rgba(0, 255, 65, 0.08), transparent);
            transform: translateY(-5px);
            box-shadow: 
                0 15px 40px rgba(0, 255, 65, 0.2),
                0 0 50px rgba(0, 255, 65, 0.1);
            border-color: rgba(0, 255, 65, 0.9);
        }

        .threat-card.critical-threat {
            border-left: 6px solid #ff0000;
            background: 
                linear-gradient(135deg, rgba(255, 0, 0, 0.15), rgba(0, 0, 0, 0.8)),
                radial-gradient(circle at 30% 70%, rgba(255, 0, 0, 0.1), transparent);
            animation: critical-threat-pulse 4s infinite;
        }

        @keyframes critical-threat-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.3); }
            50% { box-shadow: 0 0 40px rgba(255, 0, 0, 0.6), 0 0 60px rgba(255, 0, 0, 0.2); }
        }

        .threat-card.high-threat {
            border-left: 6px solid #ffd700;
            background: 
                linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(0, 0, 0, 0.8)),
                radial-gradient(circle at 30% 70%, rgba(255, 215, 0, 0.05), transparent);
        }

        .threat-header {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .threat-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #ffffff;
            line-height: 1.4;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
            font-weight: bold;
        }

        .threat-title.expandable {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .threat-title.expandable:hover {
            color: #00ff41;
            text-shadow: 0 0 15px #00ff41;
        }

        .critical-link {
            color: #ff4444;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        .critical-link:hover {
            color: #ff6666;
            text-shadow: 0 0 12px #ff4444;
        }

        .threat-badges {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .threat-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-align: center;
            min-width: 70px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .threat-badge.critical {
            background: linear-gradient(45deg, #ff0000, #cc0000);
            color: #fff;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
            animation: badge-critical 2s infinite;
        }

        @keyframes badge-critical {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .threat-badge.high {
            background: linear-gradient(45deg, #ffd700, #ffb300);
            color: #000;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .threat-badge.medium {
            background: linear-gradient(45deg, #ff9500, #ff7300);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 149, 0, 0.5);
        }

        .threat-badge.low {
            background: linear-gradient(45deg, #00ff41, #00cc33);
            color: #000;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
        }

        /* Enhanced Content Display */
        .threat-summary {
            color: #cccccc;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            position: relative;
        }

        .summary-preview {
            display: block;
        }

        .summary-full {
            display: none;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 68, 68, 0.3);
        }

        .summary-toggle {
            color: #ffd700;
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 0.8rem;
            display: inline-block;
            transition: all 0.3s ease;
            text-decoration: underline;
            font-weight: bold;
        }

        .summary-toggle:hover {
            color: #ffec8c;
            text-shadow: 0 0 8px #ffd700;
            transform: translateX(5px);
        }

        /* Enhanced Key Insights Section */
        .key-insights {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 10px;
            padding: 1.2rem;
            margin: 1.5rem 0;
        }

        .insights-title {
            color: #00ff41;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 0.8rem;
            text-transform: uppercase;
            text-shadow: 0 0 8px #00ff41;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .insights-list {
            list-style: none;
            padding: 0;
        }

        .insight-item {
            color: #ccffcc;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            padding-left: 1.2rem;
            position: relative;
            line-height: 1.4;
        }

        .insight-item::before {
            content: '▶';
            position: absolute;
            left: 0;
            color: #00ff41;
            font-size: 0.8rem;
        }

        .threat-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            border: 1px solid rgba(255, 68, 68, 0.3);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .meta-label {
            font-size: 0.75rem;
            color: #ff6666;
            text-transform: uppercase;
            font-weight: bold;
            text-shadow: 0 0 5px #ff6666;
            letter-spacing: 1px;
        }

        .meta-value {
            font-size: 0.9rem;
            color: #ffffff;
            font-weight: 500;
        }

        .source-link {
            color: #66ccff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .source-link:hover {
            color: #99ddff;
            text-shadow: 0 0 8px #66ccff;
        }

        /* Enhanced Technical Analysis */
        .technical-analysis {
            background: 
                linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05)),
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 2px,
                    rgba(255, 215, 0, 0.02) 4px
                );
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 1.8rem;
            margin-top: 1.5rem;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
        }

        .analysis-label {
            color: #ffd700;
            font-size: 0.9rem;
            font-weight: bold;
            text-shadow: 0 0 8px #ffd700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .analysis-text {
            color: #ffec8c;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1.2rem;
        }

        .actionable-items {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 215, 0, 0.4);
        }

        .actionable-title {
            color: #ffd700;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 0.8rem;
            text-transform: uppercase;
            text-shadow: 0 0 8px #ffd700;
        }

        .actionable-list {
            list-style: none;
            padding: 0;
        }

        .actionable-item {
            color: #ffec8c;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
            padding-left: 1.2rem;
            position: relative;
            line-height: 1.4;
        }

        .actionable-item::before {
            content: '⚡';
            position: absolute;
            left: 0;
            color: #ffd700;
        }

        .loading {
            text-align: center;
            color: #ff4444;
            font-size: 1.6rem;
            padding: 5rem;
            text-shadow: 0 0 15px #ff4444;
            font-family: 'Orbitron', monospace;
        }

        .error-display {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.15), rgba(255, 68, 68, 0.08));
            border: 2px solid #ff4444;
            padding: 2rem;
            border-radius: 15px;
            color: #ff6666;
            margin: 3rem 0;
            text-align: center;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(255, 68, 68, 0.3);
        }

        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: 
                linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.9)),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 48px,
                    rgba(0, 255, 65, 0.02) 50px
                );
            border-top: 2px solid #ff4444;
            padding: 1rem;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(15px);
            z-index: 1000;
            box-shadow: 0 -4px 32px rgba(0, 0, 0, 0.8);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: bold;
        }

        .status-bar a {
            color: #ffd700;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .status-bar a:hover {
            text-shadow: 0 0 12px #ffd700;
            color: #ffec8c;
        }

        .export-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ffd700;
            border-radius: 8px;
            padding: 0.8rem;
            margin-top: 0.5rem;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
        }

        .export-item {
            display: block;
            padding: 0.8rem 1.2rem;
            color: #ffd700;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .export-item:hover {
            background: rgba(255, 215, 0, 0.2);
            text-shadow: 0 0 8px #ffd700;
            transform: translateX(5px);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .threat-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .metrics-section {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .action-btn {
                width: 100%;
            }
            
            .section-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 0.8rem;
                padding: 1.5rem;
            }

            .threat-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrix"></canvas>
    <div class="matrix-overlay"></div>
    <div class="number-rain" id="numberRain"></div>
    
    <div class="header">
        <h1 class="title">PATRIOTS PROTOCOL</h1>
        <div class="subtitle">CYBER THREAT INTELLIGENCE</div>
        <div class="version-badge">ENHANCED v4.2</div>
    </div>

    <div id="app"></div>

    <div class="status-bar">
        <div class="status-item">
            <span id="intelStatus">INTELLIGENCE: INITIALIZING...</span>
        </div>
        <div class="status-item">
            LAST UPDATE: <span id="lastUpdate">SYSTEM BOOT...</span>
        </div>
        <div class="status-item">
            <span id="threatLevel">THREAT LEVEL: MONITORING</span>
        </div>
        <a href="https://github.com/danishnizmi/Patriots_Protocol" target="_blank">
            🎖️ PATRIOTS PROTOCOL ENHANCED v4.2
        </a>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function EnhancedMatrixBackground() {
            const canvasRef = useRef(null);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                
                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
                
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);

                // Only numbers and binary for Matrix effect
                const numbers = "0123456789";
                const binary = "01";
                const characters = numbers + binary;
                const matrix = characters.split("");
                const fontSize = 18;
                const columns = Math.floor(canvas.width / fontSize);
                const drops = [];

                for (let x = 0; x < columns; x++) {
                    drops[x] = Math.floor(Math.random() * -canvas.height);
                }

                function draw() {
                    // Subtle fade effect
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    ctx.font = fontSize + 'px Share Tech Mono';

                    for (let i = 0; i < drops.length; i++) {
                        // Green matrix numbers with some variation
                        const isBinary = Math.random() > 0.7;
                        const char = isBinary ? binary[Math.floor(Math.random() * binary.length)] : 
                                              numbers[Math.floor(Math.random() * numbers.length)];
                        
                        // Slight color variation - mostly green with occasional cyan
                        const alpha = Math.random() * 0.7 + 0.3;
                        ctx.fillStyle = Math.random() > 0.9 ? `rgba(102, 204, 255, ${alpha})` : `rgba(0, 255, 65, ${alpha})`;
                        
                        ctx.fillText(char, i * fontSize, drops[i] * fontSize);

                        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                            drops[i] = Math.floor(Math.random() * -100);
                        }
                        drops[i]++;
                    }
                }

                const interval = setInterval(draw, 50);
                
                return () => {
                    clearInterval(interval);
                    window.removeEventListener('resize', resizeCanvas);
                };
            }, []);

            return <canvas ref={canvasRef} className="matrix-bg" />;
        }

        function NumberRain() {
            useEffect(() => {
                const container = document.getElementById('numberRain');
                const numbers = '0123456789';
                
                function createNumberColumn() {
                    const column = document.createElement('div');
                    column.className = 'number-column';
                    column.style.left = Math.random() * 100 + '%';
                    column.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    column.style.animationDelay = Math.random() * 2 + 's';
                    
                    // Create a string of numbers for the column
                    const columnHeight = Math.floor(Math.random() * 10) + 5;
                    let numberString = '';
                    for (let i = 0; i < columnHeight; i++) {
                        numberString += numbers[Math.floor(Math.random() * numbers.length)] + '\n';
                    }
                    column.textContent = numberString;
                    
                    container.appendChild(column);
                    
                    setTimeout(() => {
                        column.remove();
                    }, 8000);
                }

                const interval = setInterval(createNumberColumn, 600);
                
                return () => clearInterval(interval);
            }, []);

            return null;
        }

        function EnhancedThreatDashboard() {
            const [threatData, setThreatData] = useState([]);
            const [metrics, setMetrics] = useState({});
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [filterLevel, setFilterLevel] = useState('ALL');
            const [filterRegion, setFilterRegion] = useState('ALL');
            const [filterFamily, setFilterFamily] = useState('ALL');
            const [sortBy, setSortBy] = useState('risk');
            const [showExportMenu, setShowExportMenu] = useState(false);
            const [expandedSummaries, setExpandedSummaries] = useState(new Set());

            const regions = [
                'ALL', 'GLOBAL', 'US', 'CA', 'AU', 'NZ', 'CN', 'JP', 'KR', 'SG',
                'IN', 'TH', 'VN', 'PH', 'MY', 'ID', 'TW', 'HK', 'GB', 'DE', 'FR',
                'IT', 'ES', 'NL', 'BE', 'SE', 'NO', 'DK', 'FI', 'PL', 'UA', 'CH',
                'AT', 'IL', 'SA', 'AE', 'TR', 'IR', 'EG', 'ZA', 'NG', 'RU', 'KP',
                'BR', 'AR', 'EU', 'APAC', 'ME', 'AF', 'LATAM'
            ];

            useEffect(() => {
                loadEnhancedIntelligence();
                const interval = setInterval(loadEnhancedIntelligence, 360000); // 6 minutes
                return () => clearInterval(interval);
            }, []);

            async function loadEnhancedIntelligence() {
                try {
                    const response = await fetch('./data/news-analysis.json?t=' + Date.now());
                    
                    if (response.ok) {
                        const data = await response.json();
                        setThreatData(data.articles || []);
                        setMetrics(data.metrics || {});
                        updateStatusIndicators(data.metrics, data.ai_usage);
                    } else {
                        throw new Error(`Failed to load: ${response.status}`);
                    }
                } catch (error) {
                    console.error('Enhanced intelligence loading error:', error);
                    setThreatData([]);
                    setMetrics({ intelligence_confidence: 0, global_threat_level: 'OFFLINE' });
                } finally {
                    setLoading(false);
                }
            }

            function updateStatusIndicators(metricsData, aiUsage) {
                const intelStatus = document.getElementById('intelStatus');
                const threatLevel = document.getElementById('threatLevel');
                const lastUpdate = document.getElementById('lastUpdate');
                
                if (intelStatus) {
                    const total = metricsData?.total_threats || 0;
                    const critical = metricsData?.critical_threats || 0;
                    const aiQuality = metricsData?.ai_analysis_quality || 0;
                    intelStatus.textContent = `INTELLIGENCE: ${total} THREATS | AI: ${aiQuality}% ${critical > 0 ? '🚨' : '✅'}`;
                }
                
                if (threatLevel) {
                    const level = metricsData?.global_threat_level || 'MONITORING';
                    const conf = metricsData?.intelligence_confidence || 0;
                    threatLevel.textContent = `THREAT LEVEL: ${level} (${conf}% CONFIDENCE)`;
                }
                
                if (lastUpdate) {
                    lastUpdate.textContent = new Date().toLocaleString();
                }
            }

            function toggleSummary(index) {
                const newExpanded = new Set(expandedSummaries);
                if (newExpanded.has(index)) {
                    newExpanded.delete(index);
                } else {
                    newExpanded.add(index);
                }
                setExpandedSummaries(newExpanded);
            }

            function getFilteredAndSortedThreats() {
                let filtered = threatData;
                
                if (searchTerm) {
                    filtered = filtered.filter(threat => 
                        threat.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        threat.summary.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        threat.threat_family?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (threat.key_insights && threat.key_insights.some(insight => 
                            insight.toLowerCase().includes(searchTerm.toLowerCase())
                        ))
                    );
                }
                
                if (filterLevel !== 'ALL') {
                    filtered = filtered.filter(threat => threat.threat_level === filterLevel);
                }
                
                if (filterRegion !== 'ALL') {
                    filtered = filtered.filter(threat => 
                        threat.country_code === filterRegion || 
                        threat.geographic_scope?.toLowerCase().includes(filterRegion.toLowerCase())
                    );
                }
                
                if (filterFamily !== 'ALL') {
                    filtered = filtered.filter(threat => threat.threat_family === filterFamily);
                }
                
                filtered.sort((a, b) => {
                    switch (sortBy) {
                        case 'risk':
                            return (b.risk_score || 0) - (a.risk_score || 0);
                        case 'level':
                            const levelOrder = { 'CRITICAL': 4, 'HIGH': 3, 'MEDIUM': 2, 'LOW': 1 };
                            return levelOrder[b.threat_level] - levelOrder[a.threat_level];
                        case 'timestamp':
                        default:
                            return new Date(b.timestamp || 0) - new Date(a.timestamp || 0);
                    }
                });
                
                return filtered;
            }

            function getThreatFamilies() {
                const families = [...new Set(threatData.map(t => t.threat_family).filter(Boolean))];
                return ['ALL', ...families.sort()];
            }

            function exportData(format) {
                const filtered = getFilteredAndSortedThreats();
                const timestamp = new Date().toISOString().split('T')[0];
                
                if (format === 'json') {
                    const data = JSON.stringify({ 
                        threats: filtered, 
                        metrics, 
                        exported: new Date(),
                        version: "4.2"
                    }, null, 2);
                    downloadFile(data, `patriots-protocol-enhanced-${timestamp}.json`, 'application/json');
                } else if (format === 'csv') {
                    const headers = ['Title', 'Threat Level', 'Risk Score', 'Family', 'Source', 'Geographic Scope', 'Key Insights'];
                    const rows = filtered.map(t => [
                        t.title, t.threat_level, t.risk_score || 0, t.threat_family || '', 
                        t.source, t.geographic_scope || '', 
                        (t.key_insights || []).join('; ').substring(0, 200)
                    ]);
                    const csv = [headers, ...rows].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
                    downloadFile(csv, `patriots-protocol-enhanced-${timestamp}.csv`, 'text/csv');
                }
                setShowExportMenu(false);
            }

            function downloadFile(content, filename, contentType) {
                const blob = new Blob([content], { type: contentType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            }

            function createBetterInsights(threat) {
                const insights = [];
                const content = (threat.title + ' ' + threat.summary + ' ' + (threat.full_summary || '')).toLowerCase();
                
                // Generate specific insights based on content
                if (content.includes('zero-day') || content.includes('0-day')) {
                    insights.push('Zero-day exploit requires immediate patch prioritization and vulnerability scanning');
                }
                if (content.includes('ransomware')) {
                    insights.push('Ransomware threat - verify backup integrity and test recovery procedures immediately');
                }
                if (content.includes('supply chain')) {
                    insights.push('Supply chain attack affects vendor security dependencies and third-party integrations');
                }
                if (content.includes('critical') && content.includes('patch')) {
                    insights.push('Critical security updates available - prioritize deployment across all affected systems');
                }
                if (content.includes('microsoft') && content.includes('patch tuesday')) {
                    insights.push('Microsoft Patch Tuesday - schedule maintenance windows for Windows systems updates');
                }
                if (content.includes('apt') || content.includes('nation-state')) {
                    insights.push('Advanced persistent threat - enhance monitoring and threat hunting capabilities');
                }
                if (content.includes('phishing') || content.includes('email')) {
                    insights.push('Email-based attack vector - strengthen email security and user awareness training');
                }
                if (content.includes('data breach') || content.includes('leaked')) {
                    insights.push('Data exposure incident - conduct data inventory and access control review');
                }
                
                // Add general insight if no specific ones found
                if (insights.length === 0) {
                    if (threat.risk_score >= 7) {
                        insights.push('High-risk security incident requiring immediate security team attention');
                    } else if (threat.risk_score >= 5) {
                        insights.push('Moderate security concern requiring assessment and monitoring');
                    } else {
                        insights.push('Security awareness update for ongoing threat landscape monitoring');
                    }
                }
                
                return insights.slice(0, 3); // Limit to 3 insights
            }

            function createBetterTechnicalAnalysis(threat) {
                const content = (threat.title + ' ' + threat.summary).toLowerCase();
                
                // Create specific technical analysis based on content
                if (content.includes('zero-day')) {
                    return `Zero-day vulnerability exploitation detected. This represents an unknown security flaw being actively exploited by threat actors before patches are available. Immediate threat hunting and defensive measures required.`;
                }
                if (content.includes('ransomware')) {
                    const family = content.includes('lockbit') ? 'LockBit' : 
                                  content.includes('conti') ? 'Conti' : 
                                  content.includes('anubis') ? 'Anubis' : 'ransomware';
                    return `${family} ransomware operation detected with file encryption and potential data exfiltration capabilities. This attack vector typically involves initial access through phishing or credential compromise, followed by lateral movement and data encryption for ransom demands.`;
                }
                if (content.includes('supply chain')) {
                    return `Supply chain compromise affecting downstream organizations through trusted vendor relationships. This attack vector exploits the trust relationships between organizations and their technology providers to gain unauthorized access to multiple targets simultaneously.`;
                }
                if (content.includes('patch tuesday')) {
                    const vulnCount = content.match(/(\d+)\s+vulnerabilities?/i);
                    const count = vulnCount ? vulnCount[1] : 'multiple';
                    return `Microsoft Patch Tuesday release addressing ${count} security vulnerabilities across Windows and related products. Includes critical remote code execution flaws and privilege escalation vulnerabilities requiring immediate deployment prioritization.`;
                }
                if (content.includes('phishing')) {
                    return `Sophisticated phishing campaign targeting user credentials and system access. This social engineering attack leverages convincing fake communications to trick users into revealing sensitive information or installing malicious software.`;
                }
                if (content.includes('apt') || content.includes('nation-state')) {
                    return `Advanced Persistent Threat (APT) activity indicating sophisticated threat actor with long-term access objectives. These campaigns typically involve advanced techniques, custom malware, and extended dwell time for intelligence gathering or infrastructure disruption.`;
                }
                
                // Fallback based on threat family and risk score
                const family = threat.threat_family || 'security incident';
                if (threat.risk_score >= 7) {
                    return `High-severity ${family.toLowerCase()} with significant impact potential. This threat requires immediate security team response and may involve advanced attack techniques targeting critical business operations or sensitive data.`;
                } else if (threat.risk_score >= 5) {
                    return `Moderate-severity ${family.toLowerCase()} requiring security assessment and monitoring. This threat represents ongoing risk to organizational security posture and should be addressed through standard security procedures.`;
                } else {
                    return `Low-severity ${family.toLowerCase()} for situational awareness and baseline security monitoring. This represents general threat landscape activity that should be tracked but does not require immediate response actions.`;
                }
            }

            function createBetterActionableItems(threat) {
                const content = (threat.title + ' ' + threat.summary).toLowerCase();
                const actions = [];
                
                if (content.includes('patch') || content.includes('update')) {
                    actions.push('Deploy security patches immediately on all affected systems');
                    actions.push('Conduct vulnerability scans to identify unpatched systems');
                }
                if (content.includes('zero-day')) {
                    actions.push('Implement network segmentation to limit attack surface');
                    actions.push('Enable advanced endpoint detection and response monitoring');
                }
                if (content.includes('ransomware')) {
                    actions.push('Test backup systems and offline recovery procedures');
                    actions.push('Block known ransomware indicators at network perimeter');
                }
                if (content.includes('phishing')) {
                    actions.push('Configure advanced email filtering and anti-phishing controls');
                    actions.push('Conduct targeted security awareness training for employees');
                }
                if (content.includes('data breach') || content.includes('exposed')) {
                    actions.push('Audit data access controls and user permissions');
                    actions.push('Monitor for unauthorized data access or exfiltration');
                }
                
                // Add general actions if none specific
                if (actions.length === 0) {
                    if (threat.risk_score >= 7) {
                        actions.push('Escalate to security incident response team immediately');
                        actions.push('Enhance monitoring for related threat indicators');
                    } else {
                        actions.push('Monitor threat developments and security advisories');
                        actions.push('Review current security controls effectiveness');
                    }
                }
                
                return actions.slice(0, 4); // Limit to 4 actions
            }

            function renderAnalyticsPanel() {
                const geoDistribution = metrics.geographic_distribution || {};
                
                return (
                    <div className="analytics-panel">
                        <div className="analytics-title">🌍 GLOBAL THREAT DISTRIBUTION</div>
                        <div className="threat-map">
                            {Object.entries(geoDistribution)
                                .sort(([,a], [,b]) => b - a)
                                .slice(0, 8)
                                .map(([country, count]) => (
                                <div key={country} className="country-threat"
                                     style={{
                                         display: 'flex',
                                         justifyContent: 'space-between',
                                         padding: '0.8rem',
                                         margin: '0.5rem 0',
                                         background: 'rgba(255, 68, 68, 0.1)',
                                         borderRadius: '8px',
                                         border: '1px solid rgba(255, 68, 68, 0.3)',
                                         cursor: 'pointer',
                                         transition: 'all 0.3s ease'
                                     }}
                                     onClick={() => setFilterRegion(country)}
                                     onMouseEnter={(e) => {
                                         e.target.style.background = 'rgba(255, 68, 68, 0.2)';
                                         e.target.style.transform = 'translateX(5px)';
                                     }}
                                     onMouseLeave={(e) => {
                                         e.target.style.background = 'rgba(255, 68, 68, 0.1)';
                                         e.target.style.transform = 'translateX(0)';
                                     }}>
                                    <span style={{color: '#ffffff', fontWeight: 'bold'}}>{country}</span>
                                    <span style={{color: '#ff6666'}}>{count} threats</span>
                                </div>
                            ))}
                        </div>
                        
                        {metrics.trending_threats && metrics.trending_threats.length > 0 && (
                            <div style={{marginTop: '2rem'}}>
                                <div style={{
                                    color: '#ffd700',
                                    fontSize: '1.1rem',
                                    fontWeight: 'bold',
                                    marginBottom: '1rem',
                                    textShadow: '0 0 10px #ffd700',
                                    textAlign: 'center'
                                }}>📈 TRENDING HIGH-RISK THREATS</div>
                                {metrics.trending_threats.slice(0, 3).map((trend, index) => (
                                    <div key={index} style={{
                                        padding: '1rem',
                                        margin: '0.8rem 0',
                                        background: 'rgba(255, 215, 0, 0.08)',
                                        border: '1px solid rgba(255, 215, 0, 0.3)',
                                        borderRadius: '8px'
                                    }}>
                                        <div style={{
                                            color: '#ffffff',
                                            fontSize: '0.9rem',
                                            fontWeight: 'bold',
                                            marginBottom: '0.5rem'
                                        }}>{trend.title?.substring(0, 60)}...</div>
                                        <div style={{
                                            color: '#ffcc99',
                                            fontSize: '0.8rem'
                                        }}>
                                            Risk: {trend.risk_score}/10 | {trend.threat_family} | {trend.threat_level}
                                        </div>
                                        {trend.key_insight && (
                                            <div style={{
                                                color: '#ffd700',
                                                fontSize: '0.75rem',
                                                marginTop: '0.5rem',
                                                fontStyle: 'italic'
                                            }}>💡 {trend.key_insight}</div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                );
            }

            function renderEnhancedTechnicalAnalysis(threat, index) {
                // Create better technical analysis
                const technicalAnalysis = createBetterTechnicalAnalysis(threat);
                const actionableItems = createBetterActionableItems(threat);
                
                return (
                    <div className="technical-analysis">
                        <div className="analysis-header">
                            <div className="analysis-label">🔍 ENHANCED TECHNICAL ANALYSIS</div>
                            <div className="threat-badge" style={{fontSize: '0.6rem'}}>
                                {threat.attack_sophistication || 'ENHANCED'}
                            </div>
                        </div>
                        
                        <div className="analysis-text">
                            {technicalAnalysis}
                        </div>
                        
                        {threat.business_impact && (
                            <div style={{
                                background: 'rgba(255, 215, 0, 0.1)',
                                border: '1px solid rgba(255, 215, 0, 0.3)',
                                padding: '0.8rem',
                                borderRadius: '6px',
                                margin: '1rem 0',
                                fontSize: '0.85rem'
                            }}>
                                <strong style={{color: '#ffd700'}}>Business Impact:</strong> {threat.business_impact}
                            </div>
                        )}
                        
                        {actionableItems && actionableItems.length > 0 && (
                            <div className="actionable-items">
                                <div className="actionable-title">⚡ IMMEDIATE ACTIONS</div>
                                <ul className="actionable-list">
                                    {actionableItems.map((item, idx) => (
                                        <li key={idx} className="actionable-item">{item}</li>
                                    ))}
                                </ul>
                            </div>
                        )}
                    </div>
                );
            }

            if (loading) {
                return (
                    <div className="container">
                        <div className="loading">
                            🎖️ PATRIOTS PROTOCOL v4.2 ENHANCED INTELLIGENCE LOADING...
                        </div>
                    </div>
                );
            }

            if (threatData.length === 0 && metrics.intelligence_confidence === 0) {
                return (
                    <div className="container">
                        <div className="error-display">
                            ⚠️ ENHANCED CYBER INTELLIGENCE NETWORK OFFLINE
                            <div style={{marginTop: '1rem', fontSize: '0.9rem', opacity: 0.8}}>
                                System attempting reconnection to intelligence sources...
                            </div>
                        </div>
                    </div>
                );
            }

            const filteredThreats = getFilteredAndSortedThreats();
            const threatFamilies = getThreatFamilies();

            return (
                <div className="container">
                    <div className="enhanced-controls">
                        <div className="controls-header">
                            <div className="controls-title">🎯 ENHANCED THREAT INTELLIGENCE CONTROLS</div>
                            <div className="live-indicator">
                                <div className="live-dot"></div>
                                LIVE MONITORING (6H UPDATES)
                            </div>
                        </div>
                        
                        <div className="filter-grid">
                            <div className="filter-group">
                                <div className="filter-label">Search Threats</div>
                                <input 
                                    type="text" 
                                    className="search-input"
                                    placeholder="Search titles, families, insights..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                />
                            </div>
                            
                            <div className="filter-group">
                                <div className="filter-label">Threat Level</div>
                                <select 
                                    className="filter-select" 
                                    value={filterLevel} 
                                    onChange={(e) => setFilterLevel(e.target.value)}
                                >
                                    <option value="ALL">ALL THREATS</option>
                                    <option value="CRITICAL">CRITICAL</option>
                                    <option value="HIGH">HIGH</option>
                                    <option value="MEDIUM">MEDIUM</option>
                                    <option value="LOW">LOW</option>
                                </select>
                            </div>
                            
                            <div className="filter-group">
                                <div className="filter-label">Geographic Region</div>
                                <select 
                                    className="filter-select" 
                                    value={filterRegion} 
                                    onChange={(e) => setFilterRegion(e.target.value)}
                                >
                                    {regions.map(region => (
                                        <option key={region} value={region}>{region}</option>
                                    ))}
                                </select>
                            </div>
                            
                            <div className="filter-group">
                                <div className="filter-label">Threat Family</div>
                                <select 
                                    className="filter-select" 
                                    value={filterFamily} 
                                    onChange={(e) => setFilterFamily(e.target.value)}
                                >
                                    {threatFamilies.map(family => (
                                        <option key={family} value={family}>{family}</option>
                                    ))}
                                </select>
                            </div>
                            
                            <div className="filter-group">
                                <div className="filter-label">Sort By</div>
                                <select 
                                    className="filter-select" 
                                    value={sortBy} 
                                    onChange={(e) => setSortBy(e.target.value)}
                                >
                                    <option value="risk">Risk Score</option>
                                    <option value="level">Threat Level</option>
                                    <option value="timestamp">Latest First</option>
                                </select>
                            </div>
                        </div>
                        
                        <div className="action-buttons">
                            <button className="action-btn" onClick={() => loadEnhancedIntelligence()}>
                                🔄 REFRESH
                            </button>
                            <div style={{position: 'relative'}}>
                                <button 
                                    className="action-btn" 
                                    onClick={() => setShowExportMenu(!showExportMenu)}
                                >
                                    📊 EXPORT
                                </button>
                                {showExportMenu && (
                                    <div className="export-menu">
                                        <a className="export-item" onClick={() => exportData('json')}>
                                            Export Enhanced JSON
                                        </a>
                                        <a className="export-item" onClick={() => exportData('csv')}>
                                            Export Enhanced CSV
                                        </a>
                                    </div>
                                )}
                            </div>
                            <button className="action-btn" onClick={() => {
                                setSearchTerm('');
                                setFilterLevel('ALL');
                                setFilterRegion('ALL');
                                setFilterFamily('ALL');
                                setSortBy('risk');
                            }}>
                                🗑️ CLEAR
                            </button>
                        </div>
                    </div>

                    <div className="dashboard-grid">
                        <div className="metrics-section">
                            <div className={`metric-card ${metrics.global_threat_level === 'CRITICAL' ? 'critical' : ''}`}>
                                <div className="metric-title">ACTIVE THREATS</div>
                                <div className="metric-value">{metrics.total_threats || 0}</div>
                                <div className="metric-details">Critical: {metrics.critical_threats || 0} | High: {metrics.high_threats || 0}</div>
                            </div>
                            
                            <div className="metric-card">
                                <div className="metric-title">AI ANALYSIS QUALITY</div>
                                <div className="metric-value">{metrics.ai_analysis_quality || 0}%</div>
                                <div className="metric-details">Confidence: {metrics.intelligence_confidence || 0}%</div>
                            </div>
                            
                            <div className="metric-card">
                                <div className="metric-title">THREAT LANDSCAPE</div>
                                <div className="metric-value">{metrics.global_threat_level || 'MONITORING'}</div>
                                <div className="metric-details">Evolution: {metrics.threat_evolution || 'stable'}</div>
                            </div>
                            
                            <div className="metric-card">
                                <div className="metric-title">ZERO-DAY ACTIVITY</div>
                                <div className="metric-value">{metrics.zero_day_count || 0}</div>
                                <div className="metric-details">Recent 24h: {metrics.fresh_intel_24h || 0}</div>
                            </div>
                            
                            <div className="metric-card">
                                <div className="metric-title">GEOGRAPHIC COVERAGE</div>
                                <div className="metric-value">{Object.keys(metrics.geographic_distribution || {}).length}</div>
                                <div className="metric-details">Regions monitored</div>
                            </div>
                            
                            <div className="metric-card">
                                <div className="metric-title">THREAT FAMILIES</div>
                                <div className="metric-value">{metrics.top_threat_families?.length || 0}</div>
                                <div className="metric-details">Active families</div>
                            </div>
                        </div>

                        {renderAnalyticsPanel()}
                    </div>

                    <div className="intelligence-section">
                        <div className="section-header">
                            <div className="section-title">🎖️ ENHANCED THREAT INTELLIGENCE</div>
                            <div className="section-stats">
                                <span>Showing {filteredThreats.length} of {threatData.length} threats</span>
                                <span>AI Quality: {metrics.ai_analysis_quality || 0}%</span>
                                <span>Filter: {filterLevel !== 'ALL' ? filterLevel : 'All Levels'}</span>
                            </div>
                        </div>
                        
                        <div className="threat-grid">
                            {filteredThreats.map((threat, index) => {
                                const enhancedInsights = createBetterInsights(threat);
                                
                                return (
                                <div key={index} className={`threat-card ${
                                    threat.threat_level === 'CRITICAL' ? 'critical-threat' : 
                                    threat.threat_level === 'HIGH' ? 'high-threat' : ''
                                }`}>
                                    <div className="threat-badges">
                                        <span className={`threat-badge ${threat.threat_level?.toLowerCase() || 'medium'}`}>
                                            {threat.threat_level || 'MEDIUM'}
                                        </span>
                                        {threat.risk_score >= 8 && (
                                            <span className="threat-badge critical">HIGH RISK</span>
                                        )}
                                    </div>
                                    
                                    <div className="threat-header">
                                        <div className="threat-title">
                                            {threat.source_url ? (
                                                <a href={threat.source_url} target="_blank" rel="noopener noreferrer" 
                                                   className={threat.threat_level === 'CRITICAL' ? 'critical-link' : 'source-link'}>
                                                    {threat.threat_level === 'CRITICAL' ? '🚨 ' : ''}{threat.title}
                                                </a>
                                            ) : (
                                                <>
                                                    {threat.threat_level === 'CRITICAL' ? '🚨 ' : ''}{threat.title}
                                                </>
                                            )}
                                        </div>
                                    </div>
                                    
                                    {/* Enhanced Key Insights Section */}
                                    {enhancedInsights && enhancedInsights.length > 0 && (
                                        <div className="key-insights">
                                            <div className="insights-title">
                                                💡 KEY INSIGHTS
                                            </div>
                                            <ul className="insights-list">
                                                {enhancedInsights.map((insight, idx) => (
                                                    <li key={idx} className="insight-item">{insight}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    )}
                                    
                                    <div className="threat-summary">
                                        <div className="summary-preview">
                                            {threat.summary_preview || threat.summary}
                                        </div>
                                        {threat.full_summary && threat.full_summary !== threat.summary && threat.full_summary.length > (threat.summary?.length || 0) + 50 && (
                                            <>
                                                <div className={`summary-full`} 
                                                     style={{display: expandedSummaries.has(index) ? 'block' : 'none'}}>
                                                    {threat.full_summary}
                                                </div>
                                                <span className="summary-toggle" 
                                                      onClick={() => toggleSummary(index)}>
                                                    {expandedSummaries.has(index) ? '▲ Show Less' : '▼ Read Full Summary'}
                                                </span>
                                            </>
                                        )}
                                    </div>
                                    
                                    <div className="threat-meta">
                                        <div className="meta-item">
                                            <div className="meta-label">SOURCE</div>
                                            <div className="meta-value">
                                                {threat.source_url ? (
                                                    <a href={threat.source_url} target="_blank" rel="noopener noreferrer" className="source-link">
                                                        {threat.source} ↗
                                                    </a>
                                                ) : threat.source}
                                            </div>
                                        </div>
                                        
                                        <div className="meta-item">
                                            <div className="meta-label">FAMILY</div>
                                            <div className="meta-value">{threat.threat_family || 'Unknown'}</div>
                                        </div>
                                        
                                        <div className="meta-item">
                                            <div className="meta-label">RISK SCORE</div>
                                            <div className="meta-value">{threat.risk_score || 5}/10</div>
                                        </div>
                                        
                                        <div className="meta-item">
                                            <div className="meta-label">GEOGRAPHIC SCOPE</div>
                                            <div className="meta-value">{threat.geographic_scope || 'Global'}</div>
                                        </div>
                                        
                                        <div className="meta-item">
                                            <div className="meta-label">CONFIDENCE</div>
                                            <div className="meta-value">{Math.round((threat.confidence_score || 0) * 100)}%</div>
                                        </div>
                                        
                                        <div className="meta-item">
                                            <div className="meta-label">PRIORITY</div>
                                            <div className="meta-value">{threat.mitigation_priority || 'ROUTINE'}</div>
                                        </div>
                                    </div>
                                    
                                    {renderEnhancedTechnicalAnalysis(threat, index)}
                                </div>
                            )})}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(
            <>
                <EnhancedMatrixBackground />
                <NumberRain />
                <EnhancedThreatDashboard />
            </>,
            document.getElementById('app')
        );
    </script>
</body>
</html>
